<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>pkglet - Hybrid Package Manager Documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>pkglet</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/builder.html">builder</a></li>
  <li><a href="../modules/cli.html">cli</a></li>
  <li><strong>config</strong></li>
  <li><a href="../modules/conflict.html">conflict</a></li>
  <li><a href="../modules/example-manifest.html">example-manifest</a></li>
  <li><a href="../modules/fetcher.html">fetcher</a></li>
  <li><a href="../modules/installer.html">installer</a></li>
  <li><a href="../modules/loader.html">loader</a></li>
  <li><a href="../modules/resolver.html">resolver</a></li>
  <li><a href="../modules/search.html">search</a></li>
  <li><a href="../modules/sync.html">sync</a></li>
  <li><a href="../modules/version.html">version</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>config</code></h1>
<p>Configuration management module for pkglet system settings and paths</p>

<p> This module centralizes all configuration management for the pkglet package manager,
 including filesystem paths, repository configurations, package options, and system
 settings.</p>
<p> It handles dynamic configuration loading from various config files and
 environment variables, allowing for flexible system deployment. The module manages
 directory creation, configuration file parsing, and runtime configuration updates
 that support bootstrap installations and custom deployment scenarios.</p>

<p> Configuration is loaded from multiple sources: environment variables for paths,
 configuration files for repositories and package settings, and runtime modifications
 for bootstrap operations. This layered approach provides both system-wide defaults
 and user-specific customizations.</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#add_repo">add_repo (name, path)</a></td>
	<td class="summary">Add a new repository</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_make_opts">get_make_opts ()</a></td>
	<td class="summary">Retrieve make system configuration options for parallel builds</p>

<p> This function loads make configuration from the make.lua file, providing
 build system parameters that control parallel compilation and resource usage.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#init">init ()</a></td>
	<td class="summary">Initialize the entire configuration system and create necessary directories</p>

<p> This function performs one-time initialization of the pkglet configuration system
 by creating all required directories (database, build, and distfiles directories)
 and loading configuration from various files.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#is_pinned">is_pinned (package_name)</a></td>
	<td class="summary">Check if a package is pinned to a specific version</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#load_masks">load_masks ()</a></td>
	<td class="summary">Load package mask list from the package.mask configuration file</p>

<p> This function reads the package mask file to identify packages that should
 not be installed or updated.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#load_package_options">load_package_options ()</a></td>
	<td class="summary">Load package-specific build options from the package.opts directory structure</p>

<p> This function scans the package options directory for individual package option
 files and loads them into the config.package_options table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#load_pins">load_pins ()</a></td>
	<td class="summary">Load package pin list from the package.lock configuration file</p>

<p> This function reads the package pin file to identify packages that should
 be locked to specific versions.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#load_repos">load_repos ()</a></td>
	<td class="summary">Load repository configuration from the repos.conf file</p>

<p> This function parses the repository configuration file to populate the
 config.repos table with available package repositories.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#pin_package">pin_package (package_name, version)</a></td>
	<td class="summary">Pin a package to a specific version</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#remove_repo">remove_repo (name)</a></td>
	<td class="summary">Remove a repository</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#set_bootstrap_root">set_bootstrap_root (path)</a></td>
	<td class="summary">Configure system for bootstrap installation mode</p>

<p> This function updates all path configurations to point to a bootstrap root
 directory, enabling pkglet to install packages to an alternate filesystem
 hierarchy.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#unpin_package">unpin_package (package_name)</a></td>
	<td class="summary">Unpin a package, allowing automatic upgrades</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "add_repo"></a>
    <strong>add_repo (name, path)</strong>
    </dt>
    <dd>
    Add a new repository


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
         string Repository name
        </li>
        <li><span class="parameter">path</span>
         string Repository path
        </li>
    </ul>





</dd>
    <dt>
    <a name = "get_make_opts"></a>
    <strong>get_make_opts ()</strong>
    </dt>
    <dd>

<p>Retrieve make system configuration options for parallel builds</p>

<p> This function loads make configuration from the make.lua file, providing
 build system parameters that control parallel compilation and resource usage.
 The configuration supports job count limits for parallel builds, load average
 thresholds to prevent system overload, and custom make arguments for special
 build requirements. These settings are essential for optimizing build performance
 while maintaining system stability.</p>

<p> The function returns sensible defaults if no configuration file exists,
 ensuring that the build system remains functional in minimal installations.
 The Lua-based configuration allows for complex conditional logic and dynamic
 parameter calculation based on system capabilities.</p>

<pre><code>           load (load average threshold), and extra (additional make arguments)
</code></pre>




    <h3>Returns:</h3>
    <ol>

        table Configuration options containing: jobs (parallel job count),
    </ol>




</dd>
    <dt>
    <a name = "init"></a>
    <strong>init ()</strong>
    </dt>
    <dd>
    Initialize the entire configuration system and create necessary directories</p>

<p> This function performs one-time initialization of the pkglet configuration system
 by creating all required directories (database, build, and distfiles directories)
 and loading configuration from various files.  It establishes the runtime
 environment needed for package operations, ensuring that all paths exist and
 configuration data is available before any package operations begin.</p>

<p> The initialization process is critical for system startup and must be called
 before any other pkglet operations to ensure the system is in a consistent state.
 It creates directories with proper permissions and loads repository information,
 package options, and package masks from their respective configuration files.







</dd>
    <dt>
    <a name = "is_pinned"></a>
    <strong>is_pinned (package_name)</strong>
    </dt>
    <dd>
    Check if a package is pinned to a specific version


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">package_name</span>
         string Name of the package to check
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string|nil Pinned version, or nil if not pinned
    </ol>




</dd>
    <dt>
    <a name = "load_masks"></a>
    <strong>load_masks ()</strong>
    </dt>
    <dd>
    Load package mask list from the package.mask configuration file</p>

<p> This function reads the package mask file to identify packages that should
 not be installed or updated.  Package masking is a critical safety feature
 that prevents problematic packages from being installed, whether due to
 known bugs, security issues, or system incompatibilities. The mask list
 provides administrators with fine-grained control over package availability.</p>

<p> Each line in the mask file represents a package name pattern that should
 be blocked. The function supports comment lines starting with # for
 documentation and ignores empty lines, making the mask file maintainable
 and self-documenting.







</dd>
    <dt>
    <a name = "load_package_options"></a>
    <strong>load_package_options ()</strong>
    </dt>
    <dd>
    Load package-specific build options from the package.opts directory structure</p>

<p> This function scans the package options directory for individual package option
 files and loads them into the config.package_options table.  Each file in the
 directory corresponds to a specific package and contains build options that
 should be applied when that package is built. The system supports flexible
 per-package configuration while maintaining clean separation of settings.</p>

<p> Options are stored as a table of boolean flags for each package, enabling
 conditional build behavior based on user preferences or system requirements.
 The function handles missing directories gracefully and ignores non-parseable
 content, ensuring robust operation in various deployment scenarios.







</dd>
    <dt>
    <a name = "load_pins"></a>
    <strong>load_pins ()</strong>
    </dt>
    <dd>
    Load package pin list from the package.lock configuration file</p>

<p> This function reads the package pin file to identify packages that should
 be locked to specific versions.  Package pinning prevents automatic upgrades
 of critical packages, ensuring system stability by maintaining known working
 versions. The pin list provides administrators with fine-grained control over
 package version management.</p>

<p> Each line in the pin file specifies a package name and exact version that
 should be enforced. The function supports comment lines starting with # for
 documentation and ignores empty lines, making the pin file maintainable and
 self-documenting.







</dd>
    <dt>
    <a name = "load_repos"></a>
    <strong>load_repos ()</strong>
    </dt>
    <dd>
    Load repository configuration from the repos.conf file</p>

<p> This function parses the repository configuration file to populate the
 config.repos table with available package repositories.  The configuration
 file uses a simple format with each line containing a repository name
 followed by its filesystem path. Lines starting with # are treated as
 comments and ignored, allowing for documentation within the config file.</p>

<p> The function handles missing files gracefully by returning early if
 the repos.conf file doesn't exist, which allows the system to function
 in minimal configurations or during initial setup.







</dd>
    <dt>
    <a name = "pin_package"></a>
    <strong>pin_package (package_name, version)</strong>
    </dt>
    <dd>
    Pin a package to a specific version


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">package_name</span>
         string Name of the package to pin
        </li>
        <li><span class="parameter">version</span>
         string Version to pin the package to
        </li>
    </ul>





</dd>
    <dt>
    <a name = "remove_repo"></a>
    <strong>remove_repo (name)</strong>
    </dt>
    <dd>
    Remove a repository


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
         string Repository name to remove
        </li>
    </ul>





</dd>
    <dt>
    <a name = "set_bootstrap_root"></a>
    <strong>set_bootstrap_root (path)</strong>
    </dt>
    <dd>
    Configure system for bootstrap installation mode</p>

<p> This function updates all path configurations to point to a bootstrap root
 directory, enabling pkglet to install packages to an alternate filesystem
 hierarchy.  Bootstrap mode is essential for system installation, container
 creation, and recovery operations where packages must be installed to a
 temporary or target root rather than the running system.</p>

<p> The function updates all derived paths to maintain consistency, ensuring
 that database, cache, and configuration operations use the bootstrap
 location. This allows for complete system isolation during installation
 while preserving full package manager functionality.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">path</span>

<p> string The target root directory for bootstrap installation,</p>
<pre><code>               which will become the new base for all pkglet operations
</code></pre>

        </li>
    </ul>





</dd>
    <dt>
    <a name = "unpin_package"></a>
    <strong>unpin_package (package_name)</strong>
    </dt>
    <dd>
    Unpin a package, allowing automatic upgrades


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">package_name</span>
         string Name of the package to unpin
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/lunarmodules/LDoc">LDoc 1.5.0</a></i>
<i style="float:right;">Last updated 2026-02-19 22:58:40 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
